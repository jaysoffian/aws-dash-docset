<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>AWS::EC2::EIPAssociation - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="AWS_EC2.html" title="EC2 Resource Type Reference">
      <link rel="prev" href="aws-properties-ec2-eip.html" title="AWS::EC2::EIP">
      <link rel="next" href="aws-resource-ec2-egressonlyinternetgateway.html" title="AWS::EC2::EgressOnlyInternetGateway">
      <meta name="description" content="Associates an Elastic IP address with an instance or a network interface. Before you can use an Elastic IP address, you must allocate it to your account.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <meta name="tocs" content="toc-contents.json;toc-AWS_EC2.json">
      <meta name="marketingLocale" content="en_US">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-eip-association.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20181221"></script><link rel="stylesheet" type="text/css" href="../../../css/marketing-target.css"><script type="text/javascript" src="/assets/marketing/js/marketing-target.js"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> &#xBB; <a href="/cloudformation/index.html">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="AWS_EC2.html">EC2 Resource Type Reference</a> &#xBB; <span class="breadcrumb">AWS::EC2::EIPAssociation</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <div id="language-filter" class="page-header" style="display:none">
                        <form> Filter View: 
                           <select name="filter-select" id="filter-select">
                              <option selected="1">All</option>
                              <option value="JSON" selected>JSON</option>
                              <option value="YAML" selected>YAML</option></select></form>
                     </div>
                     <h1 class="topictitle" id="aws-properties-ec2-eip-association">AWS::EC2::EIPAssociation</h1>
                     <p>Associates an Elastic IP address with an instance or a network interface. 
                        		   Before you can use an Elastic IP address, you must allocate it to your account.
                     </p>
                     <p>An Elastic IP address is for use in either the EC2-Classic platform or in a VPC.
                        			For more information, see <a href="./AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">Elastic IP Addresses</a> 
                        		   in the <em>Amazon Elastic Compute Cloud User Guide</em>.
                     </p>
                     <p>[EC2-Classic, VPC in an EC2-VPC-only account] If the Elastic IP address is already
                        			associated with a different instance, it is disassociated from that instance and
                        associated
                        			with the specified instance. If you associate an Elastic IP address with an instance
                        that has
                        			an existing Elastic IP address, the existing address is disassociated from the
                        instance, but
                        			remains allocated to your account.
                     </p>
                     <p>[VPC in an EC2-Classic account] If you don&apos;t specify a private IP address, the Elastic
                        			IP address is associated with the primary IP address. If the Elastic IP address
                        is already
                        			associated with a different instance or a network interface, you get an error unless
                        you allow
                        			reassociation. You cannot associate an Elastic IP address with an instance or network
                        			interface that has an existing Elastic IP address.
                     </p>
                     <h2 id="aws-properties-ec2-eip-association-syntax">Syntax</h2>
                     <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-properties-ec2-eip-association-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
  &quot;Properties&quot; : {
      &quot;<a href="#cfn-ec2-eipassociation-allocationid">AllocationId</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-ec2-eipassociation-eip">EIP</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-ec2-eipassociation-instanceid">InstanceId</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-ec2-eipassociation-networkinterfaceid">NetworkInterfaceId</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-ec2-eipassociation-PrivateIpAddress">PrivateIpAddress</a>&quot; : <em class="replaceable"><code>String</code></em>
    }
}
</code></pre></div>
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-properties-ec2-eip-association-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">Type: AWS::EC2::EIPAssociation
Properties: 
  <a href="#cfn-ec2-eipassociation-allocationid">AllocationId</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-ec2-eipassociation-eip">EIP</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-ec2-eipassociation-instanceid">InstanceId</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-ec2-eipassociation-networkinterfaceid">NetworkInterfaceId</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-ec2-eipassociation-PrivateIpAddress">PrivateIpAddress</a>: <em class="replaceable"><code>String</code></em>
</code></pre></div>
                     <h2 id="aws-properties-ec2-eip-association-properties">Properties</h2>
                     <div class="variablelist">
                        <dl>
                           <dt><a id="cfn-ec2-eipassociation-allocationid"></a><span class="term"><code class="code">AllocationId</code></span></dt>
                           <dd>
                              
                              <p>[EC2-VPC] The allocation ID. This is required for EC2-VPC.</p>
                              
                              <p><em>Required</em>: Conditional
                              </p>
                              <p><em>Type</em>: String
                              </p>
                           </dd>
                           <dt><a id="cfn-ec2-eipassociation-eip"></a><span class="term"><code class="code">EIP</code></span></dt>
                           <dd>
                              
                              <p>The Elastic IP address to associate with the instance. This is required for EC2-Classic.</p>
                              
                              <p><em>Required</em>: Conditional
                              </p>
                              <p><em>Type</em>: String
                              </p>
                           </dd>
                           <dt><a id="cfn-ec2-eipassociation-instanceid"></a><span class="term"><code class="code">InstanceId</code></span></dt>
                           <dd>
                              
                              <p>The ID of the instance. This is required for EC2-Classic. For EC2-VPC, you can specify
                                 either the instance ID or the network interface ID, but not both. The operation fails
                                 if you specify an instance ID unless exactly one network interface is attached.
                              </p>
                              
                              <p><em>Required</em>: Conditional
                              </p>
                              <p><em>Type</em>: String
                              </p>
                           </dd>
                           <dt><a id="cfn-ec2-eipassociation-networkinterfaceid"></a><span class="term"><code class="code">NetworkInterfaceId</code></span></dt>
                           <dd>
                              
                              <p>[EC2-VPC] The ID of the network interface. If the instance has more than one network
                                 interface, you must specify a network interface ID.
                              </p>
                              	     
                              <p>For EC2-VPC, you can specify either the instance ID or the network interface ID, but
                                 not both. 
                              </p>
                              
                              <p><em>Required</em>: Conditional
                              </p>
                              <p><em>Type</em>: String
                              </p>
                           </dd>
                           <dt><a id="cfn-ec2-eipassociation-PrivateIpAddress"></a><span class="term"><code class="code">PrivateIpAddress</code></span></dt>
                           <dd>
                              
                              <p>[EC2-VPC] The primary or secondary private IP address to associate with the Elastic
                                 IP address. If no private IP address is specified, the Elastic IP address is associated
                                 with the primary private IP address.
                              </p>
                              
                              <p><em>Required</em>: No
                              </p>
                              <p><em>Type</em>: String
                              </p>
                              <p><em>Update requires</em>: <a href="./AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                           </dd>
                        </dl>
                     </div>
                     <h2 id="aws-properties-ec2-eip-association-return-values">Return Values</h2>
                     <h3 id="aws-properties-ec2-eip-association-return-values-ref">Ref</h3>
                     <p>When you pass the logical ID of this resource to the intrinsic <code class="code">Ref</code> function, <code class="code">Ref</code> returns the resource name.
                     </p>
                     <p>For more information about using the <code class="code">Ref</code> function, see <a href="./AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a>.
                     </p>
                     <h2 id="aws-properties-ec2-eip-association--examples">Examples</h2>
                     <h3 id="aws-properties-ec2-eip-association--examples--Associating_an_Elastic_IP_address_to_an_instance">Associating an Elastic IP address to an instance</h3>
                     <p>The following example creates an instance with two elastic network interfaces (ENI).
                        The 
                        			example assumes that you have an existing VPC.
                     </p>
                     <p>For additional examples, see <a href="./AWSCloudFormation/latest/UserGuide/quickref-ec2.html#scenario-ec2-eip">Assigning an 
                           			Amazon EC2 Elastic IP Using AWS::EC2::EIP Snippet</a>.
                     </p>
                     <h4 id="aws-properties-ec2-eip-association--examples--Associating_an_Elastic_IP_address_to_an_instance--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">  &quot;Resources&quot; : {
    &quot;ControlPortAddress&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
        &quot;Properties&quot; : {
            &quot;Domain&quot; : &quot;vpc&quot;
        }
    },
    &quot;AssociateControlPort&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
        &quot;Properties&quot; : {
            &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;ControlPortAddress&quot;, &quot;AllocationId&quot; ]},
            &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;controlXface&quot; }
        }
    },
    &quot;WebPortAddress&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
        &quot;Properties&quot; : {
            &quot;Domain&quot; : &quot;vpc&quot;
        }
    },
    &quot;AssociateWebPort&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
        &quot;Properties&quot; : {
            &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;WebPortAddress&quot;, &quot;AllocationId&quot; ]},
            &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;webXface&quot; }
        }
    },
    &quot;SSHSecurityGroup&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
        &quot;Properties&quot; : {
            &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
            &quot;GroupDescription&quot; : &quot;Enable SSH access via port 22&quot;,
            &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : &quot;22&quot;, &quot;ToPort&quot; : &quot;22&quot;, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
        }
    },
    &quot;WebSecurityGroup&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
        &quot;Properties&quot; : {
            &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
            &quot;GroupDescription&quot; : &quot;Enable HTTP access via user defined port&quot;,
            &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : 80, &quot;ToPort&quot; : 80, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
        }
    },
    &quot;controlXface&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
        &quot;Properties&quot; : {
            &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
            &quot;Description&quot; :&quot;Interface for control traffic such as SSH&quot;,
            &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;SSHSecurityGroup&quot;} ],
            &quot;SourceDestCheck&quot; : &quot;true&quot;,
            &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Control&quot;}]
        }
    },
    &quot;webXface&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
        &quot;Properties&quot; : {
            &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
            &quot;Description&quot; :&quot;Interface for web traffic&quot;,
            &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;WebSecurityGroup&quot;} ],
            &quot;SourceDestCheck&quot; : &quot;true&quot;,
            &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Web&quot;}]
        }
    },
    &quot;Ec2Instance&quot; : {
        &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
        &quot;Properties&quot; : {
            &quot;ImageId&quot; : { &quot;Fn::FindInMap&quot; : [ &quot;RegionMap&quot;, { &quot;Ref&quot; : &quot;AWS::Region&quot; }, &quot;AMI&quot; ]},
            &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
            &quot;NetworkInterfaces&quot; : [ { &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;controlXface&quot;}, &quot;DeviceIndex&quot; : &quot;0&quot; }, { &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;webXface&quot;}, &quot;DeviceIndex&quot; : &quot;1&quot; }],
            &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Role&quot;, &quot;Value&quot; : &quot;Test Instance&quot;}],
            &quot;UserData&quot; : {&quot;Fn::Base64&quot; : { &quot;Fn::Join&quot; : [&quot;&quot;,[&quot;#!/bin/bash -ex&quot;,&quot;\n&quot;, &quot;\n&quot;,&quot;yum install ec2-net-utils -y&quot;,&quot;\n&quot;, &quot;ec2ifup eth1&quot;,&quot;\n&quot;, &quot;service httpd start&quot;]]}}
        }
    }
}</code></pre><h3 id="aws-properties-ec2-eip-association--examples--"></h3>
                     <h4 id="aws-properties-ec2-eip-association--examples----yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">Resources:
  ControlPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateControlPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt ControlPortAddress.AllocationId
      NetworkInterfaceId: !Ref controlXface
  WebPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateWebPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt WebPortAddress.AllocationId
      NetworkInterfaceId: !Ref webXface
  SSHSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable SSH access via port 22
     SecurityGroupIngress:
     - CidrIp: 0.0.0.0/0
       FromPort: 22
       IpProtocol: tcp
       ToPort: 22
  WebSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable HTTP access via user defined port
      SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: 80
        IpProtocol: tcp
        ToPort: 80
  controlXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref SSHSecurityGroup
      SourceDestCheck: true
      Tags:
      - Key: Network
        Value: Control
  webXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref WebSecurityGroup
      SourceDestCheck: true
      Tags:
      - Key: Network
        Value: Web
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: !FindInMap [ RegionMap, !Ref &apos;AWS::Region&apos;, AMI ]
      KeyName: !Ref KeyName
      NetworkInterfaces:
      - NetworkInterfaceId: !Ref controlXface
        DeviceIndex: 0
      - NetworkInterfaceId: !Ref webXface
        DeviceIndex: 1
      Tags:
      - Key: Role
        Value: Test Instance
UserData:
  Fn::Base64: !Sub |
    #!/bin/bash -xe
    yum install ec2-net-utils -y
    ec2ifup eth1
    service httpd start</code></pre><div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                       browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be
                                    enabled. Please refer to your browser's Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="aws-properties-ec2-eip.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="aws-resource-ec2-egressonlyinternetgateway.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2019, Amazon Web Services, Inc. or its affiliates. All rights
                        reserved.
                     </div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Syntax"><a class="pagetoc" href="#aws-properties-ec2-eip-association-syntax">Syntax</a></li>
                        <li class="pagetoc" name="Properties"><a class="pagetoc" href="#aws-properties-ec2-eip-association-properties">Properties</a></li>
                        <li class="pagetoc" name="Return Values"><a class="pagetoc" href="#aws-properties-ec2-eip-association-return-values">Return Values</a></li>
                        <li class="pagetoc" name="Examples"><a class="pagetoc" href="#aws-properties-ec2-eip-association--examples">Examples</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using
            our site, you consent to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>