<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Detect Drift on an Entire CloudFormation Stack - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="using-cfn-stack-drift.html" title="Detecting Unmanaged Configuration Changes to Stacks and
            Resources">
      <link rel="prev" href="using-cfn-stack-drift.html" title="Detecting Unmanaged Configuration Changes to Stacks and
            Resources">
      <link rel="next" href="detect-drift-resource.html" title="">
      <meta name="description" content="Performing a drift detection operation on a stack determines whether the stack has drifted from its expected template configuration, and returns detailed information about the drift status of each resource in the stack that supports drift detection.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <meta name="tocs" content="toc-contents.json">
      <meta name="marketingLocale" content="en_US">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20181221"></script><link rel="stylesheet" type="text/css" href="../../../css/marketing-target.css"><script type="text/javascript" src="/assets/marketing/js/marketing-target.js"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> &#xBB; <a href="/cloudformation/index.html">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="stacks.html">Working with Stacks</a> &#xBB; <a href="using-cfn-stack-drift.html">Detecting Unmanaged Configuration Changes to Stacks and
                                    Resources</a> &#xBB; <span class="breadcrumb">Detect Drift on an Entire CloudFormation Stack</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="detect-drift-stack">Detect Drift on an Entire CloudFormation Stack</h1>
                     <p>Performing a drift detection operation on a stack determines whether the stack has
                        drifted from its expected template configuration, and returns detailed information
                        about
                        the drift status of each resource in the stack that supports drift detection. 
                     </p>
                     <p class="title"><b>To detect drift on an entire stack using the AWS Management Console</b></p>
                     <ol>
                        <li>
                           <p>Open the AWS CloudFormation console at
                              <a href="https://console.aws.amazon.com/cloudformation/" target="_blank">https://console.aws.amazon.com/cloudformation</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>From the list of stacks, select the stack on which you want to perform drift
                              detection. In the stack details pane, choose <b>Stack actions</b>,
                              and then choose <b>Detect drift</b>. 
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="../../..//img/console-stacks-actions-detect-drift-1.png" alt="
                        The Detect drift for current stack command selected on the Stack
                            actions menu for the selected stack.
                    " style="max-width:80%">
                              
                              
                              
                           </div>
                           
                           <p>CloudFormation displays an information bar stating that drift detection has been initiated
                              for the selected stack.
                           </p>
                           
                           
                        </li>
                        <li>
                           <p>Wait until CloudFormation completes the drift detection operation. When the drift
                              detection
                              operation completes, CloudFormation updates <b>Drift status</b> and <b>Last drift check
                                 time</b> for your stack. These fields are listed in the <b>Overview</b> section of the <b>Stack info</b> pane of the stack
                              details page.
                           </p>
                           
                           <p>The drift detection operation may take several minutes, depending on the
                              number of resources included in the stack. You can only run a single drift
                              detection operation on a given stack at the same time. CloudFormation continues
                              the drift detection operation even after you dismiss the information bar.
                           </p>
                        </li>
                        <li>
                           
                           <p>Review the drift detection results for the stack and its resources. With your
                              stack selected, from the <b>Stack actions</b> menu select <b>View drift results</b>.
                           </p>
                           
                           <p>CloudFormation lists the overall drift status of the stack, as well as the
                              last time drift detection was initiated on the stack or any of its individual
                              resources. A stack is considered to have drifted if one or more of its resources
                              have drifted. 
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="../../..//img/console-stacks-drifts-overview-1.png" alt="
                        The Drifts page for the selected stack, showing overall stack drift
                            status, drift detection status, and the last time drift detection was
                            initiated on the stack or any of its individual resources.
                    " style="max-width:80%">
                              
                              
                              
                           </div>
                           
                           
                           <p>In the <b>Resource drift status</b> section, CloudFormation
                              lists each stack resource, its drift status, and the last time drift detection
                              was initiated on the resource. The logical ID and physical ID of each resource
                              is displayed to help you identify them. In addition, for resources with a status
                              of <b>MODIFIED</b>, CloudFormation displays resource drift
                              details. 
                           </p>
                           
                           <p>You can sort the resources based on their drift status using the <b>Drift status</b>
                              column.
                           </p>
                           
                           <ol>
                              <li>
                                 <p>To view the details on a modified resource.</p>
                                 
                                 <ol>
                                    <li>
                                       
                                       <p>With the modified resource selected, select View drift details.</p>
                                       
                                       <p>CloudFormation displays the drift detail page for that resource.
                                          This page lists the resource&apos;s expected and current property
                                          values, and any differences between the two.  
                                       </p>
                                       
                                       <p>To highlight a difference, in the <b>Differences</b>
                                          section select the property name.
                                       </p>
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                <p>Added properties are highlighted in green in the <b>Current</b> column of the
                                                   <b>Details</b> section.
                                                </p>
                                             </li>
                                             <li class="listitem">
                                                <p>Deleted properties are highlighted in red in the <b>Expected</b> column of the
                                                   <b>Details</b> section.
                                                </p>
                                             </li>
                                             <li class="listitem">
                                                <p>Properties whose value have been changed are highlighted in yellow in the both
                                                   <b>Expected</b> and
                                                   <b>Current</b> columns.
                                                </p>
                                             </li>
                                          </ul>
                                       </div>
                                       
                                    </li>
                                 </ol>
                              </li>
                           </ol>
                           
                           <div class="mediaobject">
                              
                              <img src="../../..//img/console-stacks-drifts-drift-details-differences-1.png" alt="
                        The Resource drift status section of the Drift Details page, which
                            contains drift information for each resource in the stack that supports
                            drift detection. Details include drift status and expected and current
                            property values.
                    " style="max-width:100%">
                              
                              
                              
                           </div>
                           
                           
                        </li>
                     </ol>
                     <p class="title"><b>To detect drift on an entire stack using the AWS CLI</b></p>
                     <p>To detect drift on an entire stack using the AWS CLI, use the following <code class="code">aws cloudformation</code> commands:
                     </p>
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              <p><code class="code">detect-stack-drift</code> to initiate a drift detection operation on a stack.
                              </p>
                           </li>
                           <li class="listitem">
                              <p><code class="code">describe-stack-drift-detection-status</code> to monitor the status of the stack drift detection operation.
                              </p>
                           </li>
                           <li class="listitem">
                              <p><code class="code">describe-stack-resource-drifts</code> to review the details of the stack drift detection operation.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <ol>
                        <li>
                           <p>Use the <code class="code">detect-stack-drift</code> to detect drift on an entire stack. Specify the stack
                              name or ARN. You can also specify the logical IDs of any specific resources that
                              you want to use as filters for this drift detection operation.
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">PROMPT&gt; aws cloudformation detect-stack-drift --stack-name <em class="replaceable"><code>my-stack-with-resource-drift</code></em>
{
    &quot;StackDriftDetectionId&quot;: &quot;624af370-311a-11e8-b6b7-500cexample&quot;
}</code></pre></li>
                        <li>
                           <p>Because stack drift detection operations can be long-running, use
                              <code class="code">describe-stack-drift-detection-status</code> to monitor the status of
                              drift operation. This command takes the stack drift detection ID returned by the
                              <code class="code">detect-stack-drift</code> command. 
                           </p>
                           
                           <p>In the example below, we&apos;ve taken the stack drift detection ID returned by the
                              <code class="code">detect-stack-drift</code> example above and passed it as a parameter
                              to <code class="code">describe-stack-drift-detection-status</code>. The parameter returns
                              operation details that show that the drift detection operation has completed, a
                              single stack resource has drifted, and that the entire stack is considered to
                              have drifted as a result. 
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">PROMPT&gt; aws cloudformation describe-stack-drift-detection-status --stack-drift-detection-id <em class="replaceable"><code>624af370-311a-11e8-b6b7-500cexample</code></em>
{
    &quot;StackId&quot;: &quot;arn:aws:cloudformation:us-east-1:099908667365:stack/my-stack-with-resource-drift/489e5570-df85-11e7-a7d9-50example&quot;, 
    &quot;StackDriftDetectionId&quot;: &quot;624af370-311a-11e8-b6b7-500cexample&quot;, 
    &quot;StackDriftStatus&quot;: &quot;DRIFTED&quot;, 
    &quot;Timestamp&quot;: &quot;2018-03-26T17:23:22.279Z&quot;, 
    &quot;DetectionStatus&quot;: &quot;DETECTION_COMPLETE&quot;, 
    &quot;DriftedStackResourceCount&quot;: 1
}</code></pre></li>
                        <li>
                           <p>When the stack drift detection operation is complete, use the
                              <code class="code">describe-stack-resource-drifts</code> command to review the results,
                              including actual and expected property values for resources that have drifted. 
                           </p>
                           
                           <p>The example below uses the <code class="code">stack-resource-drift-status-filters</code>
                              parameter to request stack drift information for those resources that have been
                              modified or deleted. The request returns information on the one resource that
                              has been modified, including details about two of its properties whose values
                              have been changed. No resources have been deleted.
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">PROMPT&gt; aws cloudformation describe-stack-resource-drifts --stack-name <em class="replaceable"><code>my-stack-with-resource-drift</code></em> --stack-resource-drift-status-filters MODIFIED DELETED
{
    &quot;StackResourceDrifts&quot;: [
        {
            &quot;StackId&quot;: &quot;arn:aws:cloudformation:us-east-1:099908667365:stack/my-stack-with-resource-drift/489e5570-df85-11e7-a7d9-50example&quot;, 
            &quot;ActualProperties&quot;: &quot;{\&quot;ReceiveMessageWaitTimeSeconds\&quot;:0,\&quot;DelaySeconds\&quot;:120,\&quot;RedrivePolicy\&quot;:{\&quot;deadLetterTargetArn\&quot;:\&quot;arn:aws:sqs:us-east-1:099908667365:my-stack-with-resource-drift-DLQ-1BCY7HHD5QIM3\&quot;,\&quot;maxReceiveCount\&quot;:12},\&quot;MessageRetentionPeriod\&quot;:345600,\&quot;MaximumMessageSize\&quot;:262144,\&quot;VisibilityTimeout\&quot;:60,\&quot;QueueName\&quot;:\&quot;my-stack-with-resource-drift-Queue-494PBHCO76H4\&quot;}&quot;, 
            &quot;ResourceType&quot;: &quot;AWS::SQS::Queue&quot;, 
            &quot;Timestamp&quot;: &quot;2018-03-26T17:23:34.489Z&quot;, 
            &quot;PhysicalResourceId&quot;: &quot;https://sqs.us-east-1.amazonaws.com/099908667365/my-stack-with-resource-drift-Queue-494PBHCO76H4&quot;, 
            &quot;StackResourceDriftStatus&quot;: &quot;MODIFIED&quot;, 
            &quot;ExpectedProperties&quot;: &quot;{\&quot;ReceiveMessageWaitTimeSeconds\&quot;:0,\&quot;DelaySeconds\&quot;:20,\&quot;RedrivePolicy\&quot;:{\&quot;deadLetterTargetArn\&quot;:\&quot;arn:aws:sqs:us-east-1:099908667365:my-stack-with-resource-drift-DLQ-1BCY7HHD5QIM3\&quot;,\&quot;maxReceiveCount\&quot;:10},\&quot;MessageRetentionPeriod\&quot;:345600,\&quot;MaximumMessageSize\&quot;:262144,\&quot;VisibilityTimeout\&quot;:60,\&quot;QueueName\&quot;:\&quot;my-stack-with-resource-drift-Queue-494PBHCO76H4\&quot;}&quot;, 
            &quot;PropertyDifferences&quot;: [
                {
                    &quot;PropertyPath&quot;: &quot;/DelaySeconds&quot;, 
                    &quot;ActualValue&quot;: &quot;120&quot;, 
                    &quot;ExpectedValue&quot;: &quot;20&quot;, 
                    &quot;DifferenceType&quot;: &quot;NOT_EQUAL&quot;
                }, 
                {
                    &quot;PropertyPath&quot;: &quot;/RedrivePolicy/maxReceiveCount&quot;, 
                    &quot;ActualValue&quot;: &quot;12&quot;, 
                    &quot;ExpectedValue&quot;: &quot;10&quot;, 
                    &quot;DifferenceType&quot;: &quot;NOT_EQUAL&quot;
                }
            ], 
            &quot;LogicalResourceId&quot;: &quot;Queue&quot;
        }
    ]
}</code></pre>
                           </li>
                     </ol>
                     <div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                       browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be
                                    enabled. Please refer to your browser's Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="using-cfn-stack-drift.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="detect-drift-resource.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2019, Amazon Web Services, Inc. or its affiliates. All rights
                        reserved.
                     </div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper"></div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using
            our site, you consent to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>