<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>AWS::SecretsManager::SecretTargetAttachment - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="AWS_SecretsManager.html" title="AWS Secrets Manager">
      <link rel="prev" href="aws-properties-secretsmanager-secret-generatesecretstring.html" title="AWS::SecretsManager::Secret GenerateSecretString">
      <meta name="description" content="The AWS::SecretsManager::SecretTargetAttachmentresource completes the final link between a Secrets Manager secret and its associated database. This is required because each has a dependency on the other. No matter which one you create first, the other doesn&apos;t exist yet. To resolve this, you must create the resources in the following order:">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <meta name="tocs" content="toc-contents.json;toc-AWS_SecretsManager.json">
      <meta name="marketingLocale" content="en_US">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-secrettargetattachment.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20181221"></script><link rel="stylesheet" type="text/css" href="../../../css/marketing-target.css"><script type="text/javascript" src="/assets/marketing/js/marketing-target.js"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> &#xBB; <a href="/cloudformation/index.html">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="AWS_SecretsManager.html">AWS Secrets Manager</a> &#xBB; <span class="breadcrumb">AWS::SecretsManager::SecretTargetAttachment</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <div id="language-filter" class="page-header" style="display:none">
                        <form> Filter View: 
                           <select name="filter-select" id="filter-select">
                              <option selected="1">All</option>
                              <option value="JSON" selected>JSON</option>
                              <option value="YAML" selected>YAML</option></select></form>
                     </div>
                     <h1 class="topictitle" id="aws-resource-secretsmanager-secrettargetattachment">AWS::SecretsManager::SecretTargetAttachment</h1>
                     <p>The <code class="code">AWS::SecretsManager::SecretTargetAttachment</code>resource completes the final
                        link between a Secrets Manager secret and its associated database. This is required
                        because
                        each has a dependency on the other. No matter which one you create first, the other
                        doesn&apos;t
                        exist yet. To resolve this, you must create the resources in the following order:
                     </p>
                     <div class="orderedlist">
                        
                        
                        
                        
                        <ol>
                           <li>
                              
                              <p>Define the secret without referencing the service or database. You can&apos;t reference
                                 the service or database because it doesn&apos;t exist yet.
                              </p>
                              
                           </li>
                           <li>
                              
                              <p>Next, define the service or database. Include the reference to the secret to use
                                 its stored credentials to define the database&apos;s master user and password.
                              </p>
                              
                           </li>
                           <li>
                              
                              <p>Finally, define a <code class="code">SecretTargetAttachment</code>resource type to finish
                                 configuring the secret with the required database engine type and the connection
                                 details of the service or database. These details are required by a rotation
                                 function, if one is attached later by defining a <a href="./AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-rotationschedule.html">AWS::SecretsManager::RotationSchedule </a> resource type.
                              </p>
                              
                           </li>
                        </ol>
                     </div>
                     <h2 id="aws-resource-secretsmanager-secrettargetattachment-syntax">Syntax</h2>
                     <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-secretsmanager-secrettargetattachment-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  &quot;Type&quot; : &quot;AWS::SecretsManager::SecretTargetAttachment&quot;,
  &quot;Properties&quot; : {
      &quot;<a href="#cfn-secretsmanager-secrettargetattachment-secretid">SecretId</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-secretsmanager-secrettargetattachment-targetid">TargetId</a>&quot; : <em class="replaceable"><code>String</code></em>,
      &quot;<a href="#cfn-secretsmanager-secrettargetattachment-targettype">TargetType</a>&quot; : <em class="replaceable"><code>String</code></em>
    }
}
</code></pre></div>
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-secretsmanager-secrettargetattachment-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">Type: AWS::SecretsManager::SecretTargetAttachment
Properties: 
  <a href="#cfn-secretsmanager-secrettargetattachment-secretid">SecretId</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-secretsmanager-secrettargetattachment-targetid">TargetId</a>: <em class="replaceable"><code>String</code></em>
  <a href="#cfn-secretsmanager-secrettargetattachment-targettype">TargetType</a>: <em class="replaceable"><code>String</code></em>
</code></pre></div>
                     <h2 id="aws-resource-secretsmanager-secrettargetattachment-properties">Properties</h2>
                     <div class="variablelist">
                        <dl>
                           <dt><a id="cfn-secretsmanager-secrettargetattachment-secretid"></a><span class="term"><code class="code">SecretId</code></span></dt>
                           <dd>
                              
                              <p>The Amazon Resource Name (ARN) or the friendly name of the secret that contains the
                                 credentials that you want to use with the specified service or database. To reference
                                 a
                                 secret that&apos;s also created in this template, use the see <a href="./AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a> function with the secret&apos;s logical ID.
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              <p><em>Type</em>: String
                              </p>
                              <p><em>Update requires</em>: <a href="./AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                           </dd>
                           <dt><a id="cfn-secretsmanager-secrettargetattachment-targetid"></a><span class="term"><code class="code">TargetId</code></span></dt>
                           <dd>
                              
                              <p>The ARN of the service or database whose credentials are stored in the specified
                                 secret.
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              <p><em>Type</em>: String
                              </p>
                              <p><em>Minimum</em>: <code class="code">20</code></p>
                              <p><em>Maximum</em>: <code class="code">2048</code></p>
                              <p><em>Update requires</em>: <a href="./AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                           </dd>
                           <dt><a id="cfn-secretsmanager-secrettargetattachment-targettype"></a><span class="term"><code class="code">TargetType</code></span></dt>
                           <dd>
                              
                              <p>A string used by the Secrets Manager console to determine how to parse the structure
                                 of the secret
                                 text and place the values in the proper fields of the console user interface. If you
                                 created
                                 this secret using the Secrets Manager console then we recommend that you do not modify
                                 this value. If
                                 this is a custom secret, then this field is available for your use. As a best practice,
                                 do not
                                 store any sensitive information in this field. Instead, store sensitive information
                                 in the
                                 <code class="code">SecretString</code> or <code class="code">SecretBinary</code> fields to ensure that it is
                                 encrypted.
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              <p><em>Type</em>: String
                              </p>
                              <p><em>Update requires</em>: <a href="./AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                           </dd>
                        </dl>
                     </div>
                     <h2 id="aws-resource-secretsmanager-secrettargetattachment-return-values">Return Values</h2>
                     <h3 id="aws-resource-secretsmanager-secrettargetattachment-return-values-ref">Ref</h3>
                     <p>When you pass the logical ID of an
                        <code class="code">AWS::SecretsManager::SecretTargetAttachement</code> resource to the intrinsic
                        <code class="code">Ref</code> function, the function returns the ARN of the secret, such as:
                     </p>
                     <p><code class="code">arn:aws:secretsmanager:us-west-2:123456789012:secret:my-path/my-secret-name-1a2b3c</code></p>
                     <p>This enables you to reference a secret that you create in one part of the stack template
                        from within the definition of another resource from a different part of the same
                        template.
                     </p>
                     <p>For more information about using the <code class="code">Ref</code> function, see <a href="./AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a>. 
                     </p>
                     <h2 id="aws-resource-secretsmanager-secrettargetattachment--examples">Examples</h2>
                     <h3 id="aws-resource-secretsmanager-secrettargetattachment--examples--Creating_a_Secret_and_an_RDS_DB_Instance">Creating a Secret and an RDS DB Instance</h3>
                     <p>The following example creates a secret,and then creates an Amazon RDS DB instance
                        by using the credentials found in the secret for the new database&apos;s master user and
                        password. Finally, it updates the secret with the connection details of the database
                        by defining the <code class="code">SecretTargetAttachment</code>object.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>The JSON specification doesn&apos;t allow any kind of comments. See the YAML example
                           for comments.
                        </p>
                     </div>
                     <h4 id="aws-resource-secretsmanager-secrettargetattachment--examples--Creating_a_Secret_and_an_RDS_DB_Instance--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  &quot;MyRDSSecret&quot;: {
    &quot;Type&quot;: &quot;AWS::SecretsManager::Secret&quot;,
    &quot;Properties&quot;: {
      &quot;Description&quot;: &quot;This is a Secrets Manager secret for an RDS DB instance&quot;,
      &quot;GenerateSecretString&quot;: {
        &quot;SecretStringTemplate&quot;: &quot;{\&quot;username\&quot;: \&quot;admin\&quot;}&quot;,
        &quot;GenerateStringKey&quot;: &quot;password&quot;,
        &quot;PasswordLength&quot;: 16,
        &quot;ExcludeCharacters&quot;: &quot;\&quot;@/\\&quot;
      }
    }
  },
  &quot;MyRDSInstance&quot;: {
    &quot;Type&quot;: &quot;AWS::RDS::DBInstance&quot;,
    &quot;Properties&quot;: {
      &quot;AllocatedStorage&quot;: &quot;&#x2019;20&#x2019;&quot;,
      &quot;DBInstanceClass&quot;: &quot;db.t2.micro&quot;,
      &quot;Engine&quot;: &quot;mysql&quot;,
      &quot;MasterUsername&quot;: {&quot;Fn::Join&quot;: [&quot;&quot;, [&quot;{{resolve:secretsmanager:&quot;,{&quot;Ref&quot;: &quot;MyRDSSecret&quot;},&quot;:SecretString:username}}&quot;] ] },
      &quot;MasterUserPassword&quot;: {&quot;Fn::Join&quot;: [&quot;&quot;, [&quot;{{resolve:secretsmanager:&quot;,{&quot;Ref&quot;: &quot;MyRDSSecret&quot;},&quot;:SecretString:password}}&quot;] ] },
      &quot;BackupRetentionPeriod&quot;: 0,
      &quot;DBInstanceIdentifier&quot;: &quot;rotation-instance&quot;
    }
  },
  &quot;SecretRDSInstanceAttachment&quot;: {
    &quot;Type&quot;: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;,
    &quot;Properties&quot;: {
      &quot;SecretId&quot;: {&quot;Ref&quot;: &quot;MyRDSSecret&quot;},
      &quot;TargetId&quot;: {&quot;Ref&quot;: &quot;MyRDSInstance&quot;},
      &quot;TargetType&quot;: &quot;AWS::RDS::DBInstance&quot;
    }
  }
}
</code></pre><h4 id="aws-resource-secretsmanager-secrettargetattachment--examples--Creating_a_Secret_and_an_RDS_DB_Instance--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">#This is a Secret resource with a randomly generated password in its SecretString JSON.
  MyRDSSecret:
    Type: &quot;AWS::SecretsManager::Secret&quot;
    Properties:
      Description: &quot;This is a Secrets Manager secret for an RDS DB instance&quot;
      GenerateSecretString:
        SecretStringTemplate: &apos;{&quot;username&quot;: &quot;admin&quot;}&apos;
        GenerateStringKey: &quot;password&quot;
        PasswordLength: 16
        ExcludeCharacters: &apos;&quot;@/\&apos;

  # This is an RDS instance resource. The master username and password use dynamic references
  # to resolve values from Secrets Manager. The dynamic reference guarantees that CloudFormation
  # will not log or persist the resolved value. We use a Ref to the secret resource&apos;s logical id
  # to construct the dynamic reference, since the secret name is generated by CloudFormation.
  MyRDSInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      AllocatedStorage: 20
      DBInstanceClass: db.t2.micro
      Engine: mysql
      MasterUsername: !Join [&apos;&apos;, [&apos;{{resolve:secretsmanager:&apos;, !Ref MyRDSSecret, &apos;:SecretString:username}}&apos; ]]
      MasterUserPassword: !Join [&apos;&apos;, [&apos;{{resolve:secretsmanager:&apos;, !Ref MyRDSSecret, &apos;:SecretString:password}}&apos; ]]
      BackupRetentionPeriod: 0
      DBInstanceIdentifier: &apos;rotation-instance&apos;

  #This is a SecretTargetAttachment resource which updates the referenced Secret resource with properties about
  #the referenced RDS instance
  SecretRDSInstanceAttachment:
    Type: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;
    Properties:
      SecretId: !Ref MyRDSSecret
      TargetId: !Ref MyRDSInstance
      TargetType: AWS::RDS::DBInstance</code></pre><h2 id="aws-resource-secretsmanager-secrettargetattachment--seealso">See Also</h2>
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>
                                 <a href="./AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-secret.html">AWS::SecretsManager::Secret</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>
                                 <a href="./AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-rotationschedule.html">AWS::SecretsManager::RotationSchedule</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>
                                 <a href="./AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-resourcepolicy.html">AWS::SecretsManager::ResourcePolicy</a></p>
                              
                           </li>
                        </ul>
                     </div>
                     <div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                       browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be
                                    enabled. Please refer to your browser's Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="aws-properties-secretsmanager-secret-generatesecretstring.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="AWS_SecretsManager.next">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2019, Amazon Web Services, Inc. or its affiliates. All rights
                        reserved.
                     </div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Syntax"><a class="pagetoc" href="#aws-resource-secretsmanager-secrettargetattachment-syntax">Syntax</a></li>
                        <li class="pagetoc" name="Properties"><a class="pagetoc" href="#aws-resource-secretsmanager-secrettargetattachment-properties">Properties</a></li>
                        <li class="pagetoc" name="Return Values"><a class="pagetoc" href="#aws-resource-secretsmanager-secrettargetattachment-return-values">Return Values</a></li>
                        <li class="pagetoc" name="Examples"><a class="pagetoc" href="#aws-resource-secretsmanager-secrettargetattachment--examples">Examples</a></li>
                        <li class="pagetoc" name="See Also"><a class="pagetoc" href="#aws-resource-secretsmanager-secrettargetattachment--seealso">See Also</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using
            our site, you consent to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>