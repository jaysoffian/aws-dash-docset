<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Requirements and Restrictions on Lambda Functions - Amazon CloudFront</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="lambda-at-the-edge.html" title="Customizing Content at the Edge with Lambda@Edge">
      <link rel="prev" href="lambda-examples.html" title="Lambda@Edge Example Functions">
      <link rel="next" href="reports-and-monitoring.html" title="Reports, Access Logs, and Monitoring">
      <meta name="description" content="Using CloudFront with Lambda is subject to the following requirements and restrictions.">
      <meta name="keywords" content="Amazon CloudFront,CloudFront,cache,distribution,edge,geo,HTTP,HTTPS,media,origin,RTMP,streaming">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon CloudFront">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <meta name="tocs" content="toc-contents.json">
      <meta name="marketingLocale" content="en_US">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/lambda-requirements-limits.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20181221"></script><link rel="stylesheet" type="text/css" href="../../../css/marketing-target.css"><script type="text/javascript" src="/assets/marketing/js/marketing-target.js"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> &#xBB; <a href="/cloudfront/index.html">Amazon CloudFront</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="lambda-at-the-edge.html">Customizing Content at the Edge with Lambda@Edge</a> &#xBB; <span class="breadcrumb">Requirements and Restrictions on Lambda Functions</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="lambda-requirements-limits">Requirements and Restrictions on Lambda Functions</h1>
                     <p>See the following sections for requirements and restrictions on using Lambda functions
                        with CloudFront.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#lambda-requirements-distributions">CloudFront Distributions and Associations</a></li>
                           <li><a href="#lambda-requirements-cloudfront-triggers">CloudFront Triggers for Lambda Functions</a></li>
                           <li><a href="#lambda-requirements-cloudwatch-logs">CloudWatch Logs</a></li>
                           <li><a href="#lambda-header-restrictions">Headers</a></li>
                           <li><a href="#lambda-requirements-http-status-codes">HTTP Status Codes</a></li>
                           <li><a href="#lambda-requirements-lambda-function-configuration">Lambda Function Configuration and Execution
                                 					Environment</a></li>
                           <li><a href="#lambda-requirements-see-limits">Limits</a></li>
                           <li><a href="#lambda-requirements-microsoft-smooth-streaming">Microsoft Smooth Streaming</a></li>
                           <li><a href="#lambda-requirements-network-access">Network Access</a></li>
                           <li><a href="#lambda-requirements-query-strings">Query String Parameters</a></li>
                           <li><a href="#lambda-requirements-size-body-access">Size Limits for Body with the Include Body Option</a></li>
                           <li><a href="#lambda-requirements-tagging">Tagging</a></li>
                           <li><a href="#lambda-requirements-uri">URI</a></li>
                           <li><a href="#lambda-requirements-encoding">URI and Query String Encoding</a></li>
                        </ul>
                     </div>
                     			
                     <h2 id="lambda-requirements-distributions">CloudFront Distributions and Associations</h2>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p>You can create triggers (associations) for Lambda functions for a maximum of 25 distributions
                                 per AWS
                                 						account.
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>You can create a maximum of 100 triggers (associations) for a distribution. </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>You cannot associate a Lambda function with a CloudFront distribution owned by another
                                 AWS account. 
                              </p>
                              				
                           </li>
                        </ul>
                     </div>
                     		
                     			
                     <h2 id="lambda-requirements-cloudfront-triggers">CloudFront Triggers for Lambda Functions</h2>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p>You can add triggers only for a numbered version, not for <code class="code">$LATEST</code> or for aliases.
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>You can add triggers only for functions in the US East (N. Virginia) Region.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>To add triggers, the IAM execution role associated with your Lambda function must
                                 be assumable by the
                                 						service principals <code class="code">lambda.amazonaws.com</code> and <code class="code">edgelambda.amazonaws.com</code>. For more
                                 						information, <a href="lambda-edge-permissions.html">Setting IAM Permissions and Roles for Lambda@Edge</a>.
                              </p>
                              				
                           </li>
                        </ul>
                     </div>
                     		
                     			
                     <h2 id="lambda-requirements-cloudwatch-logs">CloudWatch Logs</h2>
                     			
                     <p>For information about Amazon CloudWatch Logs limits, see <a href="./AmazonCloudWatch/latest/logs/cloudwatch_limits_cwl.html">CloudWatch Logs
                           					Limits</a> in the <em>Amazon CloudWatch User Guide</em>.
                     </p>
                     		
                     			
                     <h2 id="lambda-header-restrictions">Headers</h2>
                     
                     			
                     <p>Note the following requirements and restrictions on using headers with Lambda@Edge.</p>
                     
                     			
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#lambda-blacklisted-headers">Blacklisted Headers</a></li>
                           <li><a href="#lambda-read-only-headers">Read-only Headers</a></li>
                           <li><a href="#lambda-cloudfront-star-headers">CloudFront-* Headers</a></li>
                        </ul>
                     </div>
                     
                     			
                     				
                     <h3 id="lambda-blacklisted-headers">Blacklisted Headers</h3>
                     
                     				
                     <p>Blacklisted headers aren&apos;t exposed and can&apos;t be added by Lambda@Edge functions. If
                        your Lambda function adds
                        					a blacklisted header, the request fails CloudFront validation. CloudFront returns
                        HTTP status code 502 (Bad Gateway) to
                        					the viewer.
                     </p>
                     
                     				
                     <div class="itemizedlist">
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        					
                        				
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              						
                              <p>Connection
                                 						
                              </p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Expect</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Keep-alive</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Proxy-Authenticate</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Proxy-Authorization</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Proxy-Connection</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Trailer</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>Upgrade</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Accel-Buffering</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Accel-Charset</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Accel-Limit-Rate</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Accel-Redirect</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Amz-Cf-*</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Amzn-*</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Cache</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Edge-*</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Forwarded-Proto</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>X-Real-IP</p>
                              					
                           </li>
                        </ul>
                     </div>
                     			
                     
                     			
                     				
                     <h3 id="lambda-read-only-headers">Read-only Headers</h3>
                     
                     				
                     <p>Read-only headers can be read but not edited. You can use them as input to CloudFront
                        caching logic, and your
                        					Lambda function can read the header values, but it can&apos;t change the values. If
                        your Lambda function adds or
                        					edits a read-only header, the request fails CloudFront validation. CloudFront
                        returns HTTP status code 502 (Bad Gateway)
                        					to the viewer.
                     </p>
                     
                     				
                     					
                     <h4 id="lambda-read-only-headers-viewer-request-events">Read-only Headers for CloudFront Viewer Request
                        							Events
                     </h4>
                     
                     					
                     <div class="itemizedlist">
                        						
                        						
                        						
                        						
                        					
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              							
                              <p>Content-Length</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Host</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Transfer-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Via</p>
                              						
                           </li>
                        </ul>
                     </div>
                     				
                     
                     				
                     					
                     <h4 id="lambda-read-only-headers-origin-request-events">Read-only Headers for CloudFront Origin Request
                        							Events
                     </h4>
                     
                     					
                     <div class="itemizedlist">
                        						
                        						
                        						
                        						
                        						
                        						
                        						
                        						
                        						
                        					
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              							
                              <p>Accept-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Content-Length</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>If-Modified-Since</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>If-None-Match</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>If-Range</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>If-Unmodified-Since</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Range</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Transfer-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Via</p>
                              						
                           </li>
                        </ul>
                     </div>
                     				
                     
                     				
                     					
                     <h4 id="lambda-read-only-headers-origin-response-events">Read-only Headers for CloudFront Origin
                        							Response Events
                     </h4>
                     
                     					
                     <div class="itemizedlist">
                        						
                        						
                        						
                        					
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              							
                              <p>Transfer-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Via</p>
                              						
                           </li>
                        </ul>
                     </div>
                     				
                     
                     				
                     					
                     <h4 id="lambda-read-only-headers-viewer-response-events">Read-only Headers for CloudFront Viewer
                        							Response Events
                     </h4>
                     
                     					
                     <div class="itemizedlist">
                        						
                        						
                        						
                        						
                        						
                        					
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              							
                              <p>Content-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Content-Length</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Transfer-Encoding</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Warning</p>
                              						
                           </li>
                           <li class="listitem">
                              							
                              <p>Via</p>
                              						
                           </li>
                        </ul>
                     </div>
                     				
                     			
                     
                     			
                     
                     			
                     				
                     <h3 id="lambda-cloudfront-star-headers">CloudFront-* Headers</h3>
                     
                     				
                     <p>A Lambda function can read, edit, remove, or add any of the following headers. </p>
                     				
                     <div class="itemizedlist">
                        					
                        					
                        					
                        					
                        					
                        					
                        				
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              						
                              <p>CloudFront-Forwarded-Proto</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront-Is-Desktop-Viewer</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront-Is-Mobile-Viewer</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront-Is-SmartTV-Viewer</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront-Is-Tablet-Viewer</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront-Viewer-Country</p>
                              					
                           </li>
                        </ul>
                     </div>
                     
                     				
                     <p>Note the following:</p>
                     				
                     <div class="itemizedlist">
                        					
                        					
                        					
                        					
                        				
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              						
                              <p>If you want CloudFront to add these headers, you must configure CloudFront to cache
                                 based on these headers. For
                                 							information about configuring CloudFront to cache based on specified headers,
                                 see <a href="distribution-web-values-specify.html#DownloadDistValuesForwardHeaders">Cache Based on Selected Request Headers</a> in
                                 							the topic <a href="distribution-web-values-specify.html">Values That You Specify When You Create or Update a Distribution</a>.
                              </p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>CloudFront adds the headers after the viewer request event. </p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>If the viewer adds headers that have these names, CloudFront overwrites the header
                                 values.
                              </p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>For viewer events, CloudFront-Viewer-Country is blacklisted. Blacklisted headers
                                 							aren&apos;t exposed and can&apos;t be added by Lambda@Edge functions. If your Lambda
                                 function adds a blacklisted
                                 							header, the request fails CloudFront validation, and CloudFront returns HTTP
                                 status code 502 (Bad Gateway) to the
                                 							viewer.
                              </p>
                              					
                           </li>
                        </ul>
                     </div>
                     
                     				
                     <p>For more information, see the following examples:</p>
                     				
                     <div class="itemizedlist">
                        					
                        					
                        				
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              						
                              <p><a href="lambda-examples.html#lambda-examples-redirect-based-on-country">Example: Redirecting Viewer Requests to a
                                    						Country-Specific URL</a></p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p><a href="lambda-examples.html#lambda-examples-vary-on-device-type">Example: Serving Different Versions of an Object Based
                                    						on the Device</a></p>
                              					
                           </li>
                        </ul>
                     </div>
                     
                     			
                     
                     		
                     			
                     <h2 id="lambda-requirements-http-status-codes">HTTP Status Codes</h2>
                     			
                     <p>CloudFront doesn&apos;t execute Lambda functions for viewer response events if the origin
                        returns HTTP status code 400 or
                        				higher. You also can&apos;t modify the HTTP status code from a viewer response event
                        for a successful request.
                     </p>
                     			
                     <p>You can, however, execute Lambda functions for <em>origin</em> response errors, including HTTP
                        				status codes 4xx and 5xx. For more information, see <a href="lambda-updating-http-responses.html">Updating HTTP Responses in Origin-Response Triggers</a>.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-lambda-function-configuration">Lambda Function Configuration and Execution
                        					Environment
                     </h2>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        				
                        				
                        				
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              					
                              <p>You must create functions with the <code class="code">nodejs8.10</code> or <code class="code">nodejs10.x</code> runtime
                                 						property.
                              </p>
                              					
                              					
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>If you have a function with the <code class="code">nodejs6.10</code> property, you can still edit the function
                                    						and associate it with a CloudFront distribution. For more information, see <a href="./lambda/latest/dg/runtime-support-policy.html">
                                       							Runtime Support Policy</a> in the <em>AWS Lambda Developer Guide</em>.
                                 </p>
                              </div>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>You can&apos;t configure your Lambda function to access resources inside your VPC.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>You can&apos;t associate your Lambda function to a CloudFront distribution owned by another
                                 AWS account. 
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>The Dead Letter Queue (DLQ) isn&apos;t supported.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>Environment variables aren&apos;t supported.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>Functions with Layers aren&apos;t supported.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>AWS X-Ray isn&apos;t supported.</p>
                              				
                           </li>
                        </ul>
                     </div>
                     		
                     			
                     <h2 id="lambda-requirements-see-limits">Limits</h2>
                     			
                     <p>For information about limits, see the following documentation:</p>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p><a href="cloudfront-limits.html#limits-lambda-at-edge">Limits on Lambda@Edge</a> in this guide
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p><a href="./lambda/latest/dg/limits.html">AWS Lambda Limits</a> in the
                                 							<em>AWS Lambda Developer Guide</em></p>
                              				
                           </li>
                        </ul>
                     </div>
                     		
                     			
                     <h2 id="lambda-requirements-microsoft-smooth-streaming">Microsoft Smooth Streaming</h2>
                     			
                     <p>You can&apos;t create triggers for a CloudFront distribution that you&apos;re using for on-demand
                        streaming of media files that
                        				you&apos;ve transcoded into the Microsoft Smooth Streaming format.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-network-access">Network Access</h2>
                     			
                     <p>Functions triggered by origin request and response events as well as functions triggered
                        by viewer request and
                        				response events can make network calls to resources on the internet, and to AWS
                        services such as Amazon S3 buckets,
                        				DynamoDB tables, or Amazon EC2 instances.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-query-strings">Query String Parameters</h2>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        				
                        				
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p>To access a query string in a Lambda function, use
                                 						<code class="code">event.Records[0].cf.request.querystring</code>.
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>A function can update a query string for viewer and origin request events. The updated
                                 query string
                                 						can&apos;t include spaces, control characters, or the fragment identifier (#).
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>A function can read a query string only for origin and viewer response events.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>Configuring CloudFront to cache based on query string parameters affects whether a
                                 function can access the
                                 						query string:
                              </p>
                              					
                              <div class="itemizedlist">
                                 						
                                 						
                                 					
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       							
                                       <p><b>Viewer request and response events</b> &#x2013; A function can
                                          								access a query string regardless of the setting for <a href="distribution-web-values-specify.html#DownloadDistValuesQueryString">Query String Forwarding and Caching</a>.
                                       </p>
                                       						
                                    </li>
                                    <li class="listitem">
                                       							
                                       <p><b>Origin request and response events</b> &#x2013; A function can
                                          								access a query string only if <a href="distribution-web-values-specify.html#DownloadDistValuesQueryString">Query String Forwarding and Caching</a> is set either to <b>Forward All, Cache
                                             									Based on Whitelist</b> or to <b>Forward All, Cache Based on
                                             								All</b>.
                                       </p>
                                       						
                                    </li>
                                 </ul>
                              </div>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>We recommend that you use percent encoding for the URI and query string. For more
                                 information, see <a href="lambda-requirements-limits.html#lambda-requirements-encoding">URI and Query String Encoding</a>.
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>The total size of the URI (<code class="code">event.Records[0].cf.request.uri</code>) and the query string
                                 							(<code class="code">event.Records[0].cf.request.querystring</code>) must be less than 8,192 characters.
                              </p>
                              				
                           </li>
                        </ul>
                     </div>
                     			
                     <p>For more information, see <a href="QueryStringParameters.html">Caching Content Based on Query String Parameters</a>.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-size-body-access">Size Limits for Body with the Include Body Option</h2>
                     			
                     <p>When you choose the <b>Include Body</b> option to expose the request body to your Lambda function,
                        				be aware of the following size limits for portions of the body that are exposed
                        or replaced.
                     </p>
                     			
                     <p>Note the following:</p>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p>The body is always base64 encoded by Lambda@Edge before it is exposed.</p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>If the request body is large, Lambda@Edge truncates it before exposing it.</p>
                              				
                           </li>
                        </ul>
                     </div>
                     			
                     				
                     <h3 id="lambda-requirements-size-body-access-body-exposed">Limit when Exposing Body to a Lambda
                        						Function
                     </h3>
                     				
                     <p>Lambda@Edge truncates the body that it exposes to the Lambda function as follows:</p>
                     				
                     <div class="itemizedlist">
                        					
                        					
                        				
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              						
                              <p>For viewer requests, the body is truncated at 40KB.</p>
                              					
                           </li>
                           <li class="listitem">
                              						
                              <p>For origin requests, the body is truncated at 1MB.</p>
                              					
                           </li>
                        </ul>
                     </div>
                     
                     			
                     			
                     				
                     <h3 id="lambda-requirements-size-body-access-body-returned">Limit when Returning a Request Body from
                        						a Lambda Function
                     </h3>
                     				
                     <p>If you access the request body as read-only, the full original request body is returned
                        to the
                        					origin.
                     </p>
                     				
                     <p>However, if you choose to replace the request body, the following body size limits
                        apply when it&apos;s returned
                        					from a Lambda function:
                     </p>
                     				
                     <div class="table">
                        <p class="title"><b></b></p>
                        <div class="table-contents">
                           <table id="w521aac29c63c27c11b7">
                              							
                              <tbody><tr>
                                 								
                                 <th>Type of body encoding</th>
                                 								
                                 <th>Allowed body size: Viewer request</th>
                                 								
                                 <th>Allowed body size: Origin request</th>
                                 							
                              </tr>
                              						
                              							
                              <tr>
                                 								
                                 <td>
                                    <p>text</p>
                                 </td>
                                 								
                                 <td>
                                    <p>40KB</p>
                                 </td>
                                 								
                                 <td>
                                    <p>1MB</p>
                                 </td>
                                 							
                              </tr>
                              							
                              <tr>
                                 								
                                 <td>
                                    <p>base64</p>
                                 </td>
                                 								
                                 <td>
                                    <p>53.2KB</p>
                                 </td>
                                 								
                                 <td>
                                    <p>1.33MB</p>
                                 </td>
                                 							
                              </tr>
                              						
                           </tbody></table>
                        </div>
                     </div>
                     			
                     
                     		
                     			
                     <h2 id="lambda-requirements-tagging">Tagging</h2>
                     			
                     <p>Some AWS services, including Amazon CloudFront and AWS Lambda, support <a href="https://aws.amazon.com/answers/account-management/aws-tagging-strategies/" target="_blank"> adding tags to resources within the
                           					service</a>. However, at this time, you cannot apply tags to Lambda@Edge resources. To learn
                        more about
                        				tagging in CloudFront, see <a href="tagging.html">Tagging Amazon CloudFront Distributions</a>.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-uri">URI</h2>
                     			
                     <p>If a function changes the URI for a request, that doesn&apos;t change the cache behavior
                        for the request or the
                        				origin that the request is forwarded to.
                     </p>
                     		
                     			
                     <h2 id="lambda-requirements-encoding">URI and Query String Encoding</h2>
                     			
                     <p>Lambda functions require the URI and query string to be UTF-8 encoded. (Percent encoding
                        is compatible with UTF-8
                        				encoding.) The behavior of CloudFront and Lambda depends on the following:
                     </p>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p>The encoding of the URI and query string that CloudFront received in the request from
                                 the viewer
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p>Whether the URI or query string is changed by a function that is triggered by a viewer
                                 request or origin
                                 						request event
                              </p>
                              				
                           </li>
                        </ul>
                     </div>
                     			
                     <div class="variablelist">
                        				
                        				
                        				
                        			
                        <dl>
                           					
                           <dt><b><span class="term">Values Are UTF-8 Encoded</span></b></dt>
                           					
                           <dd>
                              						
                              <p>CloudFront forwards the values to your Lambda function without changing them.</p>
                              					
                           </dd>
                           				
                           					
                           <dt><b><span class="term">Values Are ISO 8859-1 Encoded</span></b></dt>
                           					
                           <dd>
                              						
                              <p>CloudFront converts <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1" target="_blank">ISO 8859-1 character
                                    								encoding</a> to UTF-8 encoding before forwarding the values to your Lambda function.
                              </p>
                              					
                           </dd>
                           				
                           					
                           <dt><b><span class="term">Values Are Encoded Using Some Other Character Encoding</span></b></dt>
                           					
                           <dd>
                              						
                              <p>If the values are encoded using any other character encoding, CloudFront assumes that
                                 they&apos;re ISO 8859-1
                                 							encoded and tries to convert from ISO 8859-1 encoding to UTF-8 encoding.
                              </p>
                              						
                              <div class="aws-note">
                                 <p class="aws-note">Important</p>
                                 <p>The converted version might be an inaccurate interpretation of the values in the original
                                    								request. This can cause a Lambda function or your origin to produce an unintended
                                    result.
                                 </p>
                              </div>
                              					
                           </dd>
                           				
                        </dl>
                     </div>
                     			
                     <p>The value that CloudFront forwards to your origin server depends on whether functions
                        that are triggered by viewer
                        				request or origin request events change the URI or query string:
                     </p>
                     			
                     <div class="itemizedlist">
                        				
                        				
                        			
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              					
                              <p><b>If the functions don&apos;t change the URI or query string</b> &#x2013; CloudFront
                                 						forwards the values that CloudFront received in the request from the viewer
                                 to your origin server.
                              </p>
                              				
                           </li>
                           <li class="listitem">
                              					
                              <p><b>If the functions do change the URI or query string</b> &#x2013; CloudFront
                                 						forwards the UTF-8 encoded value.
                              </p>
                              				
                           </li>
                        </ul>
                     </div>
                     			
                     <p>In both cases, the behavior is unaffected by the character encoding of the request
                        from the viewer.
                     </p>
                     		
                     <div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                       browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be
                                    enabled. Please refer to your browser's Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="lambda-examples.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="reports-and-monitoring.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2019, Amazon Web Services, Inc. or its affiliates. All rights
                        reserved.
                     </div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="CloudFront Distributions and Associations"><a class="pagetoc" href="#lambda-requirements-distributions">CloudFront Distributions and Associations</a></li>
                        <li class="pagetoc" name="CloudFront Triggers for Lambda Functions"><a class="pagetoc" href="#lambda-requirements-cloudfront-triggers">CloudFront Triggers for Lambda Functions</a></li>
                        <li class="pagetoc" name="CloudWatch Logs"><a class="pagetoc" href="#lambda-requirements-cloudwatch-logs">CloudWatch Logs</a></li>
                        <li class="pagetoc" name="Headers"><a class="pagetoc" href="#lambda-header-restrictions">Headers</a></li>
                        <li class="pagetoc" name="HTTP Status Codes"><a class="pagetoc" href="#lambda-requirements-http-status-codes">HTTP Status Codes</a></li>
                        <li class="pagetoc" name="Lambda Function Configuration and Execution
					Environment"><a class="pagetoc" href="#lambda-requirements-lambda-function-configuration">Lambda Function Configuration and Execution
                              					Environment</a></li>
                        <li class="pagetoc" name="Limits"><a class="pagetoc" href="#lambda-requirements-see-limits">Limits</a></li>
                        <li class="pagetoc" name="Microsoft Smooth Streaming"><a class="pagetoc" href="#lambda-requirements-microsoft-smooth-streaming">Microsoft Smooth Streaming</a></li>
                        <li class="pagetoc" name="Network Access"><a class="pagetoc" href="#lambda-requirements-network-access">Network Access</a></li>
                        <li class="pagetoc" name="Query String Parameters"><a class="pagetoc" href="#lambda-requirements-query-strings">Query String Parameters</a></li>
                        <li class="pagetoc" name="Size Limits for Body with the Include Body Option"><a class="pagetoc" href="#lambda-requirements-size-body-access">Size Limits for Body with the Include Body Option</a></li>
                        <li class="pagetoc" name="Tagging"><a class="pagetoc" href="#lambda-requirements-tagging">Tagging</a></li>
                        <li class="pagetoc" name="URI"><a class="pagetoc" href="#lambda-requirements-uri">URI</a></li>
                        <li class="pagetoc" name="URI and Query String Encoding"><a class="pagetoc" href="#lambda-requirements-encoding">URI and Query String Encoding</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using
            our site, you consent to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon CloudFront';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>